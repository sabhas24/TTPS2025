<app-home-header></app-home-header>

<div class="container" *ngIf="!cargando; else cargandoTemplate">

  <h2 class="mt-4">Editar Mascota Perdida</h2>

  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>
  <div *ngIf="exito" class="alert alert-success">{{ exito }}</div>

  <!-- ✅ Previsualización de todas las fotos -->
  <div *ngIf="mascota.fotos.length > 0" class="row mb-4">
    <div class="col-md-4 mb-3" *ngFor="let foto of mascota.fotos">
      <img [src]="foto" alt="Foto de mascota" class="img-fluid rounded shadow" style="max-height: 300px;">
    </div>
  </div>

  <form (ngSubmit)="actualizarMascota()">

    <div class="form-group">
      <label for="nombre">Nombre</label>
      <input type="text" id="nombre" class="form-control" [(ngModel)]="mascota.nombre" name="nombre" required>
    </div>

    <div class="form-group">
      <label for="tamanio">Tamaño (kg)</label>
      <input type="number" id="tamanio" class="form-control" [(ngModel)]="mascota.tamanio" name="tamanio" required>
    </div>

    <div class="form-group">
      <label for="color">Color</label>
      <input type="text" id="color" class="form-control" [(ngModel)]="mascota.color" name="color" required>
    </div>

    <div class="form-group">
      <label for="descripcionExtra">Descripción</label>
      <textarea id="descripcionExtra" class="form-control" [(ngModel)]="mascota.descripcionExtra" name="descripcionExtra"></textarea>
    </div>

    <div class="form-group">
      <label for="fotos">Fotos (URLs separadas por coma)</label>
      <input type="text" id="fotos" class="form-control"
             [ngModel]="mascota.fotos.join(', ')"
             (ngModelChange)="onFotosChange($any($event))"
             name="fotos">
    </div>

    <div class="form-group">
      <label>Coordenadas</label>
      <div class="row">
        <div class="col">
          <input type="number" class="form-control" placeholder="Latitud"
                 [(ngModel)]="mascota.coordenada.latitud" name="latitud">
        </div>
        <div class="col">
          <input type="number" class="form-control" placeholder="Longitud"
                 [(ngModel)]="mascota.coordenada.longitud" name="longitud">
        </div>
        <div class="col">
          <input type="text" class="form-control" placeholder="Barrio"
                 [(ngModel)]="mascota.coordenada.barrio" name="barrio">
        </div>
      </div>
    </div>

    <button type="submit" class="btn btn-primary mt-3">Actualizar Mascota</button>
    <button type="button" class="btn btn-secondary mt-3" (click)="router.navigate(['/mis-mascotas'])">
      Cancelar
    </button>

  </form>
</div>

<ng-template #cargandoTemplate>
  <div class="text-center mt-5">
    <p>Cargando mascota...</p>
  </div>
</ng-template>

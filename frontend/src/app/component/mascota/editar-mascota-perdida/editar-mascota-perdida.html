<app-home-header></app-home-header>

<div class="container" *ngIf="!cargando; else cargandoTemplate">

  <h2 class="mt-4">Editar Mascota Perdida</h2>

  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>
  <div *ngIf="exito" class="alert alert-success">{{ exito }}</div>

  <!-- ✅ Foto visible -->
  <div *ngIf="mascota.fotos.length > 0" class="row mb-4">
    <div class="col-md-4 mb-3" *ngFor="let foto of mascota.fotos">
      <img [src]="foto" alt="Foto de mascota" class="img-fluid rounded shadow" style="max-height: 300px;">
    </div>
  </div>

  <!-- ✅ Cambiar foto -->
  <div class="form-group mb-3">
    <label for="fotoNueva">Cambiar foto</label>
    <input type="file" id="fotoNueva" class="form-control" (change)="onNuevaFoto($event)">
  </div>

  <form (ngSubmit)="actualizarMascota()">

    <!-- ✅ Nombre -->
    <div class="form-group mb-2">
      <label for="nombre">Nombre</label>
      <input type="text"
             id="nombre"
             class="form-control"
             [class.is-invalid]="validaciones.nombre"
             [(ngModel)]="mascota.nombre"
             name="nombre"
             required>
      <div class="invalid-feedback">{{ validaciones.nombre }}</div>
    </div>

    <!-- ✅ Tamaño -->
    <div class="form-group mb-2">
      <label for="tamanio">Tamaño (cm)</label>
      <input type="number"
             id="tamanio"
             class="form-control"
             [class.is-invalid]="validaciones.tamanio"
             [(ngModel)]="mascota.tamanio"
             name="tamanio"
             required>
      <div class="invalid-feedback">{{ validaciones.tamanio }}</div>
    </div>

    <!-- ✅ Color -->
    <div class="form-group mb-2">
      <label for="color">Color</label>
      <input type="text"
             id="color"
             class="form-control"
             [class.is-invalid]="validaciones.color"
             [(ngModel)]="mascota.color"
             name="color"
             required>
      <div class="invalid-feedback">{{ validaciones.color }}</div>
    </div>

    <!-- ✅ Descripción -->
    <div class="form-group mb-2">
      <label for="descripcionExtra">Descripción</label>
      <textarea id="descripcionExtra"
                class="form-control"
                [class.is-invalid]="validaciones.descripcion"
                [(ngModel)]="mascota.descripcionExtra"
                name="descripcionExtra"></textarea>
      <div class="invalid-feedback">{{ validaciones.descripcion }}</div>
    </div>

    <button type="submit" class="btn btn-primary mt-3">Actualizar Mascota</button>
    <button type="button" class="btn btn-secondary mt-3" (click)="volver()">
      Cancelar
    </button>

  </form>
</div>

<ng-template #cargandoTemplate>
  <div class="text-center mt-5">
    <p>Cargando mascota...</p>
  </div>
</ng-template>

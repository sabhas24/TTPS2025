<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/src/main/java/ttps/grupo2/appmascotas/controllers/MascotaController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/ttps/grupo2/appmascotas/controllers/MascotaController.java" />
              <option name="originalContent" value="package ttps.grupo2.appmascotas.controllers;&#10;&#10;import io.swagger.v3.oas.annotations.Operation;&#10;import io.swagger.v3.oas.annotations.media.ArraySchema;&#10;import io.swagger.v3.oas.annotations.media.Content;&#10;import io.swagger.v3.oas.annotations.media.Schema;&#10;import io.swagger.v3.oas.annotations.responses.ApiResponse;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.web.bind.annotation.*;&#10;import ttps.grupo2.appmascotas.DTOs.MascotasDTOs.MascotaCreateRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.MascotasDTOs.MascotaResponseDTO;&#10;import ttps.grupo2.appmascotas.DTOs.MascotasDTOs.MascotaUpdateRequestDTO;&#10;import ttps.grupo2.appmascotas.entities.EstadoMascota;&#10;import ttps.grupo2.appmascotas.services.MascotaService;&#10;&#10;import java.util.List;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/mascotas&quot;)&#10;public class MascotaController {&#10;&#10;    @Autowired&#10;    private MascotaService mascotaService;&#10;&#10;    @Operation(&#10;            summary = &quot;Publicar una nueva mascota&quot;,&#10;            description = &quot;Registra una nueva mascota en estado PERDIDO_PROPIO. Requiere el ID del usuario publicador.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;201&quot;, description = &quot;Mascota publicada exitosamente&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    schema = @Schema(implementation = MascotaResponseDTO.class)))&#10;    @PostMapping&#10;    @ResponseStatus(HttpStatus.CREATED)&#10;    public MascotaResponseDTO publicar(@RequestBody MascotaCreateRequestDTO dto) {&#10;        return mascotaService.publicarMascota(dto);&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Editar una mascota existente&quot;,&#10;            description = &quot;Actualiza los datos de una mascota habilitada. No permite modificar estado ni publicador.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Mascota actualizada correctamente&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    schema = @Schema(implementation = MascotaResponseDTO.class)))&#10;    @PutMapping(&quot;/{id}&quot;)&#10;    public MascotaResponseDTO editar(@PathVariable Long id, @RequestBody MascotaUpdateRequestDTO dto) {&#10;        return mascotaService.editarMascota(id, dto);&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Cambiar el estado de una mascota&quot;,&#10;            description = &quot;Modifica el estado de una mascota según las transiciones definidas (ej. PERDIDO → RECUPERADO).&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Estado actualizado correctamente&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    schema = @Schema(implementation = MascotaResponseDTO.class)))&#10;    @PatchMapping(&quot;/{id}/estado&quot;)&#10;    public MascotaResponseDTO cambiarEstado(@PathVariable Long id, @RequestParam EstadoMascota estado) {&#10;        return mascotaService.cambiarEstado(id, estado);&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Deshabilitar una mascota&quot;,&#10;            description = &quot;Marca una mascota como deshabilitada. No la elimina físicamente de la base de datos.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;204&quot;, description = &quot;Mascota deshabilitada correctamente&quot;)&#10;    @DeleteMapping(&quot;/{id}&quot;)&#10;    @ResponseStatus(HttpStatus.NO_CONTENT)&#10;    public void deshabilitar(@PathVariable Long id) {&#10;        mascotaService.deshabilitarMascota(id);&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Obtener mascota por ID&quot;,&#10;            description = &quot;Devuelve los datos de una mascota específica identificada por su ID.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Mascota encontrada&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    schema = @Schema(implementation = MascotaResponseDTO.class)))&#10;    @GetMapping(&quot;/{id}&quot;)&#10;    public MascotaResponseDTO obtenerPorId(@PathVariable Long id) {&#10;        return mascotaService.obtenerPorId(id);&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Listar mascotas perdidas&quot;,&#10;            description = &quot;Devuelve todas las mascotas en estado PERDIDO_PROPIO que estén habilitadas.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Listado de mascotas perdidas&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    array = @ArraySchema(schema = @Schema(implementation = MascotaResponseDTO.class))))&#10;    @GetMapping(&quot;/perdidas&quot;)&#10;    public List&lt;MascotaResponseDTO&gt; listarPerdidas() {&#10;        return mascotaService.listarMascotasPerdidas();&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Listar mascotas por usuario&quot;,&#10;            description = &quot;Devuelve todas las mascotas habilitadas publicadas por el usuario indicado.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Listado de mascotas del usuario&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    array = @ArraySchema(schema = @Schema(implementation = MascotaResponseDTO.class))))&#10;    @GetMapping(&quot;/usuario/{id}&quot;)&#10;    public List&lt;MascotaResponseDTO&gt; listarPorUsuario(@PathVariable Long id) {&#10;        return mascotaService.listarPorUsuario(id);&#10;    }&#10;}" />
              <option name="updatedContent" value="package ttps.grupo2.appmascotas.controllers;&#10;&#10;import io.swagger.v3.oas.annotations.Operation;&#10;import io.swagger.v3.oas.annotations.media.ArraySchema;&#10;import io.swagger.v3.oas.annotations.media.Content;&#10;import io.swagger.v3.oas.annotations.media.Schema;&#10;import io.swagger.v3.oas.annotations.responses.ApiResponse;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.web.bind.annotation.*;&#10;import ttps.grupo2.appmascotas.DTOs.MascotasDTOs.MascotaCreateRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.MascotasDTOs.MascotaResponseDTO;&#10;import ttps.grupo2.appmascotas.DTOs.MascotasDTOs.MascotaUpdateRequestDTO;&#10;import ttps.grupo2.appmascotas.entities.EstadoMascota;&#10;import ttps.grupo2.appmascotas.services.MascotaService;&#10;&#10;import java.util.List;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/mascotas&quot;)&#10;public class MascotaController {&#10;&#10;    @Autowired&#10;    private MascotaService mascotaService;&#10;&#10;    @Operation(&#10;            summary = &quot;Publicar una nueva mascota&quot;,&#10;            description = &quot;Registra una nueva mascota en estado PERDIDO_PROPIO. Requiere el ID del usuario publicador.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;201&quot;, description = &quot;Mascota publicada exitosamente&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    schema = @Schema(implementation = MascotaResponseDTO.class)))&#10;    @PostMapping&#10;    @ResponseStatus(HttpStatus.CREATED)&#10;    public MascotaResponseDTO publicar(@RequestBody MascotaCreateRequestDTO dto) {&#10;        return mascotaService.publicarMascota(dto);&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Editar una mascota existente&quot;,&#10;            description = &quot;Actualiza los datos de una mascota habilitada. No permite modificar estado ni publicador.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Mascota actualizada correctamente&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    schema = @Schema(implementation = MascotaResponseDTO.class)))&#10;    @PutMapping(&quot;/{id}&quot;)&#10;    public MascotaResponseDTO editar(@PathVariable Long id, @RequestBody MascotaUpdateRequestDTO dto) {&#10;        return mascotaService.editarMascota(id, dto);&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Cambiar el estado de una mascota&quot;,&#10;            description = &quot;Modifica el estado de una mascota según las transiciones definidas (ej. PERDIDO → RECUPERADO).&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Estado actualizado correctamente&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    schema = @Schema(implementation = MascotaResponseDTO.class)))&#10;    @PatchMapping(&quot;/{id}/estado&quot;)&#10;    public MascotaResponseDTO cambiarEstado(@PathVariable Long id, @RequestParam EstadoMascota estado) {&#10;        return mascotaService.cambiarEstado(id, estado);&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Deshabilitar una mascota&quot;,&#10;            description = &quot;Marca una mascota como deshabilitada. No la elimina físicamente de la base de datos.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;204&quot;, description = &quot;Mascota deshabilitada correctamente&quot;)&#10;    @DeleteMapping(&quot;/{id}&quot;)&#10;    @ResponseStatus(HttpStatus.NO_CONTENT)&#10;    public void deshabilitar(@PathVariable Long id) {&#10;        mascotaService.deshabilitarMascota(id);&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Obtener mascota por ID&quot;,&#10;            description = &quot;Devuelve los datos de una mascota específica identificada por su ID.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Mascota encontrada&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    schema = @Schema(implementation = MascotaResponseDTO.class)))&#10;    @GetMapping(&quot;/{id}&quot;)&#10;    public MascotaResponseDTO obtenerPorId(@PathVariable Long id) {&#10;        return mascotaService.obtenerPorId(id);&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Listar mascotas perdidas&quot;,&#10;            description = &quot;Devuelve todas las mascotas en estado PERDIDO_PROPIO que estén habilitadas.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Listado de mascotas perdidas&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    array = @ArraySchema(schema = @Schema(implementation = MascotaResponseDTO.class))))&#10;    @GetMapping(&quot;/perdidas&quot;)&#10;    public List&lt;MascotaResponseDTO&gt; listarPerdidas() {&#10;        return mascotaService.listarMascotasPerdidas();&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Listar mascotas por usuario&quot;,&#10;            description = &quot;Devuelve todas las mascotas habilitadas publicadas por el usuario indicado.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Listado de mascotas del usuario&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    array = @ArraySchema(schema = @Schema(implementation = MascotaResponseDTO.class))))&#10;    @GetMapping(&quot;/usuario/{id}&quot;)&#10;    public List&lt;MascotaResponseDTO&gt; listarPorUsuario(@PathVariable Long id) {&#10;        return mascotaService.listarPorUsuario(id);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/ttps/grupo2/appmascotas/controllers/UsuarioController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/ttps/grupo2/appmascotas/controllers/UsuarioController.java" />
              <option name="originalContent" value="package ttps.grupo2.appmascotas.controllers;&#10;&#10;import io.swagger.v3.oas.annotations.Operation;&#10;import io.swagger.v3.oas.annotations.responses.ApiResponse;&#10;import io.swagger.v3.oas.annotations.media.Content;&#10;import io.swagger.v3.oas.annotations.media.Schema;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.web.bind.annotation.*;&#10;import ttps.grupo2.appmascotas.DTOs.UsuariosDTOs.UsuarioCreateRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.UsuariosDTOs.UsuarioUpdateRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.UsuariosDTOs.UsuarioLoginRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.UsuariosDTOs.UsuarioResponseDTO;&#10;import ttps.grupo2.appmascotas.services.UsuarioService;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/usuarios&quot;)&#10;public class UsuarioController {&#10;&#10;    @Autowired&#10;    private UsuarioService usuarioService;&#10;&#10;    @Operation(&#10;            summary = &quot;Registrar un nuevo usuario&quot;,&#10;            description = &quot;Crea un nuevo usuario en el sistema si el email no está registrado. Devuelve los datos del usuario creado.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;201&quot;, description = &quot;Usuario registrado exitosamente&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    schema = @Schema(implementation = UsuarioResponseDTO.class)))&#10;    @PostMapping&#10;    @ResponseStatus(HttpStatus.CREATED)&#10;    public UsuarioResponseDTO registrar(@RequestBody UsuarioCreateRequestDTO dto) {&#10;        return usuarioService.registrar(dto);&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Editar perfil de usuario&quot;,&#10;            description = &quot;Actualiza los datos personales del usuario identificado por su ID. Solo se modifican campos visibles del perfil.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Perfil actualizado correctamente&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    schema = @Schema(implementation = UsuarioResponseDTO.class)))&#10;    @PutMapping(&quot;/{id}&quot;)&#10;    public UsuarioResponseDTO editarPerfil(@PathVariable Long id, @RequestBody UsuarioUpdateRequestDTO dto) {&#10;        return usuarioService.editarPerfil(id, dto);&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Deshabilitar usuario&quot;,&#10;            description = &quot;Marca al usuario como deshabilitado. No elimina el registro de la base de datos.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;204&quot;, description = &quot;Usuario deshabilitado correctamente&quot;)&#10;    @DeleteMapping(&quot;/{id}&quot;)&#10;    @ResponseStatus(HttpStatus.NO_CONTENT)&#10;    public void deshabilitar(@PathVariable Long id) {&#10;        usuarioService.deshabilitar(id);&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Login de usuario&quot;,&#10;            description = &quot;Verifica las credenciales del usuario. Si son válidas y el usuario está habilitado, devuelve sus datos.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Login exitoso&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    schema = @Schema(implementation = UsuarioResponseDTO.class)))&#10;    @PostMapping(&quot;/login&quot;)&#10;    public UsuarioResponseDTO login(@RequestBody UsuarioLoginRequestDTO dto) {&#10;        return usuarioService.login(dto);&#10;    }&#10;}" />
              <option name="updatedContent" value="package ttps.grupo2.appmascotas.controllers;&#10;&#10;import io.swagger.v3.oas.annotations.Operation;&#10;import io.swagger.v3.oas.annotations.responses.ApiResponse;&#10;import io.swagger.v3.oas.annotations.media.Content;&#10;import io.swagger.v3.oas.annotations.media.Schema;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.web.bind.annotation.*;&#10;import ttps.grupo2.appmascotas.DTOs.UsuariosDTOs.UsuarioCreateRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.UsuariosDTOs.UsuarioUpdateRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.UsuariosDTOs.UsuarioLoginRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.UsuariosDTOs.UsuarioResponseDTO;&#10;import ttps.grupo2.appmascotas.services.UsuarioService;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/usuarios&quot;)&#10;public class UsuarioController {&#10;&#10;    @Autowired&#10;    private UsuarioService usuarioService;&#10;&#10;    @Operation(&#10;            summary = &quot;Registrar un nuevo usuario&quot;,&#10;            description = &quot;Crea un nuevo usuario en el sistema si el email no está registrado. Devuelve los datos del usuario creado.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;201&quot;, description = &quot;Usuario registrado exitosamente&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    schema = @Schema(implementation = UsuarioResponseDTO.class)))&#10;    @PostMapping&#10;    @ResponseStatus(HttpStatus.CREATED)&#10;    public UsuarioResponseDTO registrar(@RequestBody UsuarioCreateRequestDTO dto) {&#10;        return usuarioService.registrar(dto);&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Editar perfil de usuario&quot;,&#10;            description = &quot;Actualiza los datos personales del usuario identificado por su ID. Solo se modifican campos visibles del perfil.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Perfil actualizado correctamente&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    schema = @Schema(implementation = UsuarioResponseDTO.class)))&#10;    @PutMapping(&quot;/{id}&quot;)&#10;    public UsuarioResponseDTO editarPerfil(@PathVariable Long id, @RequestBody UsuarioUpdateRequestDTO dto) {&#10;        return usuarioService.editarPerfil(id, dto);&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Deshabilitar usuario&quot;,&#10;            description = &quot;Marca al usuario como deshabilitado. No elimina el registro de la base de datos.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;204&quot;, description = &quot;Usuario deshabilitado correctamente&quot;)&#10;    @DeleteMapping(&quot;/{id}&quot;)&#10;    @ResponseStatus(HttpStatus.NO_CONTENT)&#10;    public void deshabilitar(@PathVariable Long id) {&#10;        usuarioService.deshabilitar(id);&#10;    }&#10;&#10;    @Operation(&#10;            summary = &quot;Login de usuario&quot;,&#10;            description = &quot;Verifica las credenciales del usuario. Si son válidas y el usuario está habilitado, devuelve sus datos.&quot;&#10;    )&#10;    @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Login exitoso&quot;,&#10;            content = @Content(mediaType = &quot;application/json&quot;,&#10;                    schema = @Schema(implementation = UsuarioResponseDTO.class)))&#10;    @PostMapping(&quot;/login&quot;)&#10;    public UsuarioResponseDTO login(@RequestBody UsuarioLoginRequestDTO dto) {&#10;        return usuarioService.login(dto);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/ttps/grupo2/appmascotas/services/MascotaService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/ttps/grupo2/appmascotas/services/MascotaService.java" />
              <option name="originalContent" value="package ttps.grupo2.appmascotas.services;&#10;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.web.server.ResponseStatusException;&#10;import org.springframework.http.HttpStatus;&#10;import ttps.grupo2.appmascotas.DTOs.MascotasDTOs.MascotaCreateRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.MascotasDTOs.MascotaUpdateRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.MascotasDTOs.MascotaResponseDTO;&#10;import ttps.grupo2.appmascotas.entities.Mascota;&#10;import ttps.grupo2.appmascotas.entities.EstadoMascota;&#10;import ttps.grupo2.appmascotas.entities.Usuario;&#10;import ttps.grupo2.appmascotas.repositories.MascotaRepository;&#10;import ttps.grupo2.appmascotas.repositories.UsuarioRepository;&#10;import ttps.grupo2.appmascotas.validations.MascotaValidator;&#10;&#10;import java.time.LocalDate;&#10;import java.util.List;&#10;&#10;@Service&#10;public class MascotaService {&#10;&#10;    @Autowired&#10;    private MascotaRepository mascotaRepository;&#10;&#10;    @Autowired&#10;    private UsuarioRepository usuarioRepository;&#10;&#10;    @Autowired&#10;    private MascotaValidator mascotaValidator;&#10;&#10;    // Crear nueva mascota&#10;    public MascotaResponseDTO publicarMascota(MascotaCreateRequestDTO dto) {&#10;        Usuario publicador = usuarioRepository.findById(dto.getPublicadorId())&#10;                .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Usuario no encontrado&quot;));&#10;&#10;        Mascota mascota = convertirDesdeCreateDTO(dto, publicador);&#10;        mascotaValidator.validar(mascota);&#10;&#10;        mascota.setEstado(EstadoMascota.PERDIDO_PROPIO);&#10;        mascota.setFechaPublicacion(LocalDate.now());&#10;        mascota.setHabilitado(true);&#10;&#10;        Mascota guardada = mascotaRepository.save(mascota);&#10;        return convertirAResponseDTO(guardada);&#10;    }&#10;&#10;    // Actualizar mascota&#10;    public MascotaResponseDTO editarMascota(Long id, MascotaUpdateRequestDTO dto) {&#10;        Mascota mascota = mascotaRepository.findById(id)&#10;                .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Mascota no encontrada&quot;));&#10;&#10;        if (!mascota.isHabilitado()) {&#10;            throw new ResponseStatusException(HttpStatus.FORBIDDEN, &quot;No se puede editar una mascota deshabilitada&quot;);&#10;        }&#10;&#10;        mascotaValidator.validarActualizacion(dto, mascota);&#10;&#10;        mascota.setNombre(dto.getNombre());&#10;        mascota.setColor(dto.getColor());&#10;        mascota.setTamanio(dto.getTamanio());&#10;        mascota.setDescripcionExtra(dto.getDescripcionExtra());&#10;        mascota.setCoordenada(dto.getCoordenada());&#10;        mascota.setFotos(dto.getFotos());&#10;&#10;        Mascota actualizada = mascotaRepository.save(mascota);&#10;        return convertirAResponseDTO(actualizada);&#10;    }&#10;&#10;    // Deshabilitar mascota&#10;    public void deshabilitarMascota(Long id) {&#10;        Mascota mascota = mascotaRepository.findById(id)&#10;                .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Mascota no encontrada&quot;));&#10;&#10;        if (!mascota.isHabilitado()) {&#10;            throw new ResponseStatusException(HttpStatus.BAD_REQUEST, &quot;La mascota ya está deshabilitada&quot;);&#10;        }&#10;&#10;        mascota.deshabilitarPublicacion();&#10;        mascotaRepository.save(mascota);&#10;    }&#10;&#10;    // Obtener mascota por ID&#10;    public MascotaResponseDTO obtenerPorId(Long id) {&#10;        Mascota mascota = mascotaRepository.findById(id)&#10;                .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Mascota no encontrada&quot;));&#10;        return convertirAResponseDTO(mascota);&#10;    }&#10;&#10;    // Cambiar estado&#10;    public MascotaResponseDTO cambiarEstado(Long id, EstadoMascota nuevoEstado) {&#10;        Mascota mascota = mascotaRepository.findById(id)&#10;                .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Mascota no encontrada&quot;));&#10;&#10;        mascota.cambiarEstado(nuevoEstado);&#10;        Mascota actualizada = mascotaRepository.save(mascota);&#10;        return convertirAResponseDTO(actualizada);&#10;    }&#10;&#10;    // Listar mascotas perdidas&#10;    public List&lt;MascotaResponseDTO&gt; listarMascotasPerdidas() {&#10;        return mascotaRepository.findByEstado(EstadoMascota.PERDIDO_PROPIO)&#10;                .stream()&#10;                .map(this::convertirAResponseDTO)&#10;                .toList();&#10;    }&#10;&#10;    // Listar mascotas por usuario&#10;    public List&lt;MascotaResponseDTO&gt; listarPorUsuario(Long usuarioId) {&#10;        return mascotaRepository.findByPublicadorIdAndHabilitadoTrue(usuarioId)&#10;                .stream()&#10;                .map(this::convertirAResponseDTO)&#10;                .toList();&#10;    }&#10;&#10;    // Conversión desde DTO de creación&#10;    private Mascota convertirDesdeCreateDTO(MascotaCreateRequestDTO dto, Usuario publicador) {&#10;        Mascota mascota = new Mascota();&#10;        mascota.setNombre(dto.getNombre());&#10;        mascota.setTamanio(dto.getTamanio());&#10;        mascota.setColor(dto.getColor());&#10;        mascota.setDescripcionExtra(dto.getDescripcionExtra());&#10;        mascota.setFotos(dto.getFotos());&#10;        mascota.setCoordenada(dto.getCoordenada());&#10;        mascota.setPublicador(publicador);&#10;        return mascota;&#10;    }&#10;&#10;    // Conversión a DTO de respuesta&#10;    private MascotaResponseDTO convertirAResponseDTO(Mascota mascota) {&#10;        MascotaResponseDTO dto = new MascotaResponseDTO();&#10;        dto.setId(mascota.getId());&#10;        dto.setNombre(mascota.getNombre());&#10;        dto.setColor(mascota.getColor());&#10;        dto.setEstado(mascota.getEstado());&#10;        dto.setFotos(mascota.getFotos());&#10;        dto.setCoordenada(mascota.getCoordenada());&#10;        dto.setNombrePublicador(mascota.getPublicador().getNombre());&#10;        return dto;&#10;    }&#10;}" />
              <option name="updatedContent" value="package ttps.grupo2.appmascotas.services;&#10;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.web.server.ResponseStatusException;&#10;import org.springframework.http.HttpStatus;&#10;import ttps.grupo2.appmascotas.DTOs.MascotasDTOs.MascotaCreateRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.MascotasDTOs.MascotaUpdateRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.MascotasDTOs.MascotaResponseDTO;&#10;import ttps.grupo2.appmascotas.entities.Mascota;&#10;import ttps.grupo2.appmascotas.entities.EstadoMascota;&#10;import ttps.grupo2.appmascotas.entities.Usuario;&#10;import ttps.grupo2.appmascotas.repositories.MascotaRepository;&#10;import ttps.grupo2.appmascotas.repositories.UsuarioRepository;&#10;import ttps.grupo2.appmascotas.validations.MascotaValidator;&#10;&#10;import java.time.LocalDate;&#10;import java.util.List;&#10;&#10;@Service&#10;public class MascotaService {&#10;&#10;    @Autowired&#10;    private MascotaRepository mascotaRepository;&#10;&#10;    @Autowired&#10;    private UsuarioRepository usuarioRepository;&#10;&#10;    @Autowired&#10;    private MascotaValidator mascotaValidator;&#10;&#10;    // Crear nueva mascota&#10;    public MascotaResponseDTO publicarMascota(MascotaCreateRequestDTO dto) {&#10;        Usuario publicador = usuarioRepository.findById(dto.getPublicadorId())&#10;                .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Usuario no encontrado&quot;));&#10;&#10;        Mascota mascota = convertirDesdeCreateDTO(dto, publicador);&#10;        mascotaValidator.validar(mascota);&#10;&#10;        mascota.setEstado(EstadoMascota.PERDIDO_PROPIO);&#10;        mascota.setFechaPublicacion(LocalDate.now());&#10;        mascota.setHabilitado(true);&#10;&#10;        Mascota guardada = mascotaRepository.save(mascota);&#10;        return convertirAResponseDTO(guardada);&#10;    }&#10;&#10;    // Actualizar mascota&#10;    public MascotaResponseDTO editarMascota(Long id, MascotaUpdateRequestDTO dto) {&#10;        Mascota mascota = mascotaRepository.findById(id)&#10;                .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Mascota no encontrada&quot;));&#10;&#10;        if (!mascota.isHabilitado()) {&#10;            throw new ResponseStatusException(HttpStatus.FORBIDDEN, &quot;No se puede editar una mascota deshabilitada&quot;);&#10;        }&#10;&#10;        mascotaValidator.validarActualizacion(dto, mascota);&#10;&#10;        mascota.setNombre(dto.getNombre());&#10;        mascota.setColor(dto.getColor());&#10;        mascota.setTamanio(dto.getTamanio());&#10;        mascota.setDescripcionExtra(dto.getDescripcionExtra());&#10;        mascota.setCoordenada(dto.getCoordenada());&#10;        mascota.setFotos(dto.getFotos());&#10;&#10;        Mascota actualizada = mascotaRepository.save(mascota);&#10;        return convertirAResponseDTO(actualizada);&#10;    }&#10;&#10;    // Deshabilitar mascota&#10;    public void deshabilitarMascota(Long id) {&#10;        Mascota mascota = mascotaRepository.findById(id)&#10;                .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Mascota no encontrada&quot;));&#10;&#10;        if (!mascota.isHabilitado()) {&#10;            throw new ResponseStatusException(HttpStatus.BAD_REQUEST, &quot;La mascota ya está deshabilitada&quot;);&#10;        }&#10;&#10;        mascota.deshabilitarPublicacion();&#10;        mascotaRepository.save(mascota);&#10;    }&#10;&#10;    // Obtener mascota por ID&#10;    public MascotaResponseDTO obtenerPorId(Long id) {&#10;        Mascota mascota = mascotaRepository.findById(id)&#10;                .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Mascota no encontrada&quot;));&#10;        return convertirAResponseDTO(mascota);&#10;    }&#10;&#10;    // Cambiar estado&#10;    public MascotaResponseDTO cambiarEstado(Long id, EstadoMascota nuevoEstado) {&#10;        Mascota mascota = mascotaRepository.findById(id)&#10;                .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Mascota no encontrada&quot;));&#10;&#10;        mascota.cambiarEstado(nuevoEstado);&#10;        Mascota actualizada = mascotaRepository.save(mascota);&#10;        return convertirAResponseDTO(actualizada);&#10;    }&#10;&#10;    // Listar mascotas perdidas&#10;    public List&lt;MascotaResponseDTO&gt; listarMascotasPerdidas() {&#10;        return mascotaRepository.findByEstado(EstadoMascota.PERDIDO_PROPIO)&#10;                .stream()&#10;                .map(this::convertirAResponseDTO)&#10;                .toList();&#10;    }&#10;&#10;    // Listar mascotas por usuario&#10;    public List&lt;MascotaResponseDTO&gt; listarPorUsuario(Long usuarioId) {&#10;        return mascotaRepository.findByPublicadorIdAndHabilitadoTrue(usuarioId)&#10;                .stream()&#10;                .map(this::convertirAResponseDTO)&#10;                .toList();&#10;    }&#10;&#10;    // Conversión desde DTO de creación&#10;    private Mascota convertirDesdeCreateDTO(MascotaCreateRequestDTO dto, Usuario publicador) {&#10;        Mascota mascota = new Mascota();&#10;        mascota.setNombre(dto.getNombre());&#10;        mascota.setTamanio(dto.getTamanio());&#10;        mascota.setColor(dto.getColor());&#10;        mascota.setDescripcionExtra(dto.getDescripcionExtra());&#10;        mascota.setFotos(dto.getFotos());&#10;        mascota.setCoordenada(dto.getCoordenada());&#10;        mascota.setPublicador(publicador);&#10;        return mascota;&#10;    }&#10;&#10;    // Conversión a DTO de respuesta&#10;    private MascotaResponseDTO convertirAResponseDTO(Mascota mascota) {&#10;        MascotaResponseDTO dto = new MascotaResponseDTO();&#10;        dto.setId(mascota.getId());&#10;        dto.setNombre(mascota.getNombre());&#10;        dto.setColor(mascota.getColor());&#10;        dto.setEstado(mascota.getEstado());&#10;        dto.setFotos(mascota.getFotos());&#10;        dto.setCoordenada(mascota.getCoordenada());&#10;        dto.setNombrePublicador(mascota.getPublicador().getNombre());&#10;        return dto;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/ttps/grupo2/appmascotas/services/UsuarioService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/ttps/grupo2/appmascotas/services/UsuarioService.java" />
              <option name="originalContent" value="package ttps.grupo2.appmascotas.services;&#10;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.web.server.ResponseStatusException;&#10;import org.springframework.http.HttpStatus;&#10;import ttps.grupo2.appmascotas.DTOs.UsuariosDTOs.UsuarioCreateRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.UsuariosDTOs.UsuarioUpdateRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.UsuariosDTOs.UsuarioLoginRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.UsuariosDTOs.UsuarioResponseDTO;&#10;import ttps.grupo2.appmascotas.entities.Usuario;&#10;import ttps.grupo2.appmascotas.repositories.UsuarioRepository;&#10;&#10;import java.util.Optional;&#10;&#10;@Service&#10;public class UsuarioService {&#10;&#10;    @Autowired&#10;    private UsuarioRepository usuarioRepository;&#10;&#10;    // Registro de usuario&#10;    public UsuarioResponseDTO registrar(UsuarioCreateRequestDTO dto) {&#10;        if (usuarioRepository.existsByEmail(dto.getEmail())) {&#10;            throw new ResponseStatusException(HttpStatus.CONFLICT, &quot;Ya existe un usuario con ese email&quot;);&#10;        }&#10;&#10;        Usuario nuevo = new Usuario();&#10;        nuevo.setNombre(dto.getNombre());&#10;        nuevo.setApellido(dto.getApellido());&#10;        nuevo.setEmail(dto.getEmail());&#10;        nuevo.setContraseña(dto.getContraseña());&#10;        nuevo.setTelefono(dto.getTelefono());&#10;        nuevo.setBarrio(dto.getBarrio());&#10;        nuevo.setCiudad(dto.getCiudad());&#10;        nuevo.setFoto(dto.getFoto());&#10;        nuevo.setHabilitado(true);&#10;&#10;        Usuario guardado = usuarioRepository.save(nuevo);&#10;        return convertirAResponseDTO(guardado);&#10;    }&#10;&#10;    // Edición de perfil&#10;    public UsuarioResponseDTO editarPerfil(Long id, UsuarioUpdateRequestDTO dto) {&#10;        Usuario usuario = usuarioRepository.findById(id)&#10;                .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Usuario no encontrado&quot;));&#10;&#10;        usuario.editarPerfil(&#10;                dto.getNombre(),&#10;                dto.getApellido(),&#10;                dto.getTelefono(),&#10;                dto.getBarrio(),&#10;                dto.getCiudad(),&#10;                dto.getFoto()&#10;        );&#10;&#10;        Usuario actualizado = usuarioRepository.save(usuario);&#10;        return convertirAResponseDTO(actualizado);&#10;    }&#10;&#10;    // Deshabilitar usuario&#10;    public void deshabilitar(Long id) {&#10;        Usuario usuario = usuarioRepository.findById(id)&#10;                .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Usuario no encontrado&quot;));&#10;&#10;        usuario.deshabilitarUsuario();&#10;        usuarioRepository.save(usuario);&#10;    }&#10;&#10;    // Login básico (sin seguridad avanzada)&#10;    public UsuarioResponseDTO login(UsuarioLoginRequestDTO dto) {&#10;        Usuario usuario = usuarioRepository.findByEmail(dto.getEmail())&#10;                .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.UNAUTHORIZED, &quot;Email no registrado&quot;));&#10;&#10;        if (!usuario.getContraseña().equals(dto.getContraseña())) {&#10;            throw new ResponseStatusException(HttpStatus.UNAUTHORIZED, &quot;Contraseña incorrecta&quot;);&#10;        }&#10;&#10;        if (!usuario.isHabilitado()) {&#10;            throw new ResponseStatusException(HttpStatus.FORBIDDEN, &quot;Usuario deshabilitado&quot;);&#10;        }&#10;&#10;        return convertirAResponseDTO(usuario);&#10;    }&#10;&#10;    // Buscar por email&#10;    public Optional&lt;Usuario&gt; buscarPorEmail(String email) {&#10;        return usuarioRepository.findByEmail(email);&#10;    }&#10;&#10;    // Conversión a DTO de respuesta&#10;    private UsuarioResponseDTO convertirAResponseDTO(Usuario usuario) {&#10;        UsuarioResponseDTO dto = new UsuarioResponseDTO();&#10;        dto.setId(usuario.getId());&#10;        dto.setNombre(usuario.getNombre());&#10;        dto.setApellido(usuario.getApellido());&#10;        dto.setEmail(usuario.getEmail());&#10;        dto.setTelefono(usuario.getTelefono());&#10;        dto.setBarrio(usuario.getBarrio());&#10;        dto.setCiudad(usuario.getCiudad());&#10;        dto.setFoto(usuario.getFoto());&#10;        return dto;&#10;    }&#10;}" />
              <option name="updatedContent" value="package ttps.grupo2.appmascotas.services;&#10;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.web.server.ResponseStatusException;&#10;import org.springframework.http.HttpStatus;&#10;import ttps.grupo2.appmascotas.DTOs.UsuariosDTOs.UsuarioCreateRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.UsuariosDTOs.UsuarioUpdateRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.UsuariosDTOs.UsuarioLoginRequestDTO;&#10;import ttps.grupo2.appmascotas.DTOs.UsuariosDTOs.UsuarioResponseDTO;&#10;import ttps.grupo2.appmascotas.entities.Usuario;&#10;import ttps.grupo2.appmascotas.repositories.UsuarioRepository;&#10;&#10;import java.util.Optional;&#10;&#10;@Service&#10;public class UsuarioService {&#10;&#10;    @Autowired&#10;    private UsuarioRepository usuarioRepository;&#10;&#10;    // Registro de usuario&#10;    public UsuarioResponseDTO registrar(UsuarioCreateRequestDTO dto) {&#10;        if (usuarioRepository.existsByEmail(dto.getEmail())) {&#10;            throw new ResponseStatusException(HttpStatus.CONFLICT, &quot;Ya existe un usuario con ese email&quot;);&#10;        }&#10;&#10;        Usuario nuevo = new Usuario();&#10;        nuevo.setNombre(dto.getNombre());&#10;        nuevo.setApellido(dto.getApellido());&#10;        nuevo.setEmail(dto.getEmail());&#10;        nuevo.setContraseña(dto.getContraseña());&#10;        nuevo.setTelefono(dto.getTelefono());&#10;        nuevo.setBarrio(dto.getBarrio());&#10;        nuevo.setCiudad(dto.getCiudad());&#10;        nuevo.setFoto(dto.getFoto());&#10;        nuevo.setHabilitado(true);&#10;&#10;        Usuario guardado = usuarioRepository.save(nuevo);&#10;        return convertirAResponseDTO(guardado);&#10;    }&#10;&#10;    // Edición de perfil&#10;    public UsuarioResponseDTO editarPerfil(Long id, UsuarioUpdateRequestDTO dto) {&#10;        Usuario usuario = usuarioRepository.findById(id)&#10;                .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Usuario no encontrado&quot;));&#10;&#10;        usuario.editarPerfil(&#10;                dto.getNombre(),&#10;                dto.getApellido(),&#10;                dto.getTelefono(),&#10;                dto.getBarrio(),&#10;                dto.getCiudad(),&#10;                dto.getFoto()&#10;        );&#10;&#10;        Usuario actualizado = usuarioRepository.save(usuario);&#10;        return convertirAResponseDTO(actualizado);&#10;    }&#10;&#10;    // Deshabilitar usuario&#10;    public void deshabilitar(Long id) {&#10;        Usuario usuario = usuarioRepository.findById(id)&#10;                .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.NOT_FOUND, &quot;Usuario no encontrado&quot;));&#10;&#10;        usuario.deshabilitarUsuario();&#10;        usuarioRepository.save(usuario);&#10;    }&#10;&#10;    // Login básico (sin seguridad avanzada)&#10;    public UsuarioResponseDTO login(UsuarioLoginRequestDTO dto) {&#10;        Usuario usuario = usuarioRepository.findByEmail(dto.getEmail())&#10;                .orElseThrow(() -&gt; new ResponseStatusException(HttpStatus.UNAUTHORIZED, &quot;Email no registrado&quot;));&#10;&#10;        if (!usuario.getContraseña().equals(dto.getContraseña())) {&#10;            throw new ResponseStatusException(HttpStatus.UNAUTHORIZED, &quot;Contraseña incorrecta&quot;);&#10;        }&#10;&#10;        if (!usuario.isHabilitado()) {&#10;            throw new ResponseStatusException(HttpStatus.FORBIDDEN, &quot;Usuario deshabilitado&quot;);&#10;        }&#10;&#10;        return convertirAResponseDTO(usuario);&#10;    }&#10;&#10;    // Buscar por email&#10;    public Optional&lt;Usuario&gt; buscarPorEmail(String email) {&#10;        return usuarioRepository.findByEmail(email);&#10;    }&#10;&#10;    // Conversión a DTO de respuesta&#10;    private UsuarioResponseDTO convertirAResponseDTO(Usuario usuario) {&#10;        UsuarioResponseDTO dto = new UsuarioResponseDTO();&#10;        dto.setId(usuario.getId());&#10;        dto.setNombre(usuario.getNombre());&#10;        dto.setApellido(usuario.getApellido());&#10;        dto.setEmail(usuario.getEmail());&#10;        dto.setTelefono(usuario.getTelefono());&#10;        dto.setBarrio(usuario.getBarrio());&#10;        dto.setCiudad(usuario.getCiudad());&#10;        dto.setFoto(usuario.getFoto());&#10;        return dto;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/resources/application.properties">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/resources/application.properties" />
              <option name="originalContent" value="spring.datasource.url=jdbc:mysql://localhost:3306/bdmascotas&#10;spring.datasource.username=root&#10;spring.datasource.password=admin&#10;spring.jpa.hibernate.ddl-auto=update&#10;spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect" />
              <option name="updatedContent" value="spring.datasource.url=jdbc:mysql://localhost:3306/bdmascotas?createDatabaseIfNotExist=true&#10;spring.datasource.username=root&#10;spring.datasource.password=admin&#10;spring.jpa.hibernate.ddl-auto=update&#10;spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>